<script>
    window.addEventListener('DOMContentLoaded', _e => {
        var title = document.title
        if (title.includes(' | ')) {
            var splitTitle = []
            splitTitle = title.split(' | ')
            splitTitle.pop()
            title = splitTitle.join(' | ')
        }

        const titleEl = document.querySelector('.header > .title')
        if (titleEl) {
            titleEl.textContent = title
        }

        if (!location.pathname.startsWith('/login')) {
            document.querySelectorAll('.nav').forEach(n => {
                n.removeAttribute('hidden')
            })
        }

        document.querySelectorAll('.input-parent, .textarea-parent, .select-parent').forEach(e => {
            var classes = e.className
            var splitClasses = []
            if (classes.includes(' ')) splitClasses = classes.split(' ')
            else splitClasses = [classes]

            var element = ''
            splitClasses.forEach(c => {
                if (c.endsWith('-parent')) element = c.slice(0, -7)
            })

            checkIfValue(e.querySelector(element) || document.documentElement);
            (e as HTMLInputElement).onkeyup = event => {
                checkIfValue((event.target as HTMLElement) || document.documentElement)
            }
        })

    })

    var cI = 0
    checkHFHeight()
    function checkHFHeight() {
        if (document.querySelector('.header')) {
            document.documentElement.style.setProperty('--h-height', `${document.querySelector('.header')?.clientHeight}px`)
        }
        if (document.querySelector('.footer')) {
            document.documentElement.style.setProperty('--f-height', `${document.querySelector('.footer')?.clientHeight}px`)
        }
        if ((!document.querySelector('.header') || !document.querySelector('.footer')) && cI < 5) {
            setTimeout(checkHFHeight, 5000)
            cI++
        }
    }
    window.addEventListener('resize', checkHFHeight)

    function checkIfValue(element: HTMLElement) {
        if ((element as HTMLInputElement).value) (element.parentNode as HTMLElement)?.setAttribute('open', '')
        else (element.parentNode as HTMLElement)?.removeAttribute('open')
    }

    function goToPage(name: string) {
        location.href = `/${name}`
    }
    window.goToPage = goToPage

    function assertError(err: unknown, name: string) {
        var aErr = `${name} Error: ${err}`
        var cErr = `Error with ${name}: ${err}`
        alert(aErr)
        console.error(cErr)
    }
    window.assertError = assertError
</script>
