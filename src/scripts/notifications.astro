<script>
    var nGroup = document.querySelector('.notifications')

    function getNotifications(_module: unknown, _title: unknown, _description: unknown, _content: unknown, _attatchmentInfo: unknown) {
        var notificationList = localStorage.getItem('notifications')
        var notificationObject = JSON.parse(notificationList || '')

        notificationObject?.forEach((name: number) => {
            // var notification = localStorage.getItem(`NOTIFICATIONS://${name}`)
            addNotification(notificationObject[name])
            notificationObject?.shift()
            localStorage.removeItem(`NOTIFICATIONS://${name}`)
        })

        notificationList = JSON.stringify(notificationObject)
        localStorage.setItem('notifications', notificationList)
    }
    window.getNotifications = getNotifications

    function addNotification(notification: { icon: string, title: string, content: string }) {
        var nIcon = notification.icon
        var nTitle = notification.title
        var nContent = notification.content

        var nEle = document.createElement('item')

        var nEleIcon = document.createElement('img')
        nEleIcon.classList.add('icon')
        nEleIcon.src = `/icons/${nIcon}.svg`
        nEle.appendChild(nEleIcon)

        var nEleContent = document.createElement('item-content')
        nEleContent.textContent = nTitle
        nEle.appendChild(nEleContent)

        nGroup?.appendChild(nEle)

        nEle.onclick = _e => {
            if (!!nContent) {
                window.showModal(nTitle, nContent)
            }
        }
    }
</script>
