<script is:inline>
function makeRequest(moduleName, params = [], callback) {
    // Prepare params for API route
    const paramsString = Array.isArray(params) && params.length > 0
        ? JSON.stringify(params)
        : ''

    // Build URL for our API route
    const url = `/api/511?module=${encodeURIComponent(moduleName)}${paramsString ? `&params=${encodeURIComponent(paramsString)}` : ''}`

    fetch(url)
        .then(response => {
            if (!response.ok) {
                throw new Error(`HTTP error! status: ${response.status}`)
            }
            return response.json()
        })
        .then(data => {
            if (data.error) {
                throw new Error(data.error)
            }
            callback(data)
        })
        .catch(err => {
            console.error('511 API Error:', err)
        })
}
</script>
